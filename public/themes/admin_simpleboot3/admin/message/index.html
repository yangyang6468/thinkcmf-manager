<include file="public@header"/>

    <style type="text/css">

        #Barrage {
            width: 85%;
            max-height: 530px;
            border:1px solid #ccc9a4;
            border-radius: 11px;
            margin-top: 10px;
            overflow: hidden;
        }

        .BarMes {
            border-radius: 5px;
            background-color: rgba(205, 204, 204,.4);
            border: 1px solid rgba(204, 204, 204,.2);
            padding: 0 10px;
            height: 40px;
            display: inline-block;
            cursor: pointer;
            max-width: 500px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .time {
            border-radius: 5px;
            background-color: rgba(205, 204, 204,.4);
            border: 1px solid rgba(204, 204, 204,.2);
            padding: 0 10px;
            height: 40px;
            display: inline-block;
            cursor: pointer;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        #Barrage ul {
            display: block;

        }

        li {
            border-radius: 5px;
            list-style-type: none;
            width: 100%;
            display: block;
            text-align: left;
            line-height: 38px;
            font-family: '仿宋';
            margin-top: 10px;
            word-break: keep-all;
            /* 不换行 */
            white-space: nowrap;
            /* 不换行 */
            overflow: hidden;
        }

        #Barrage ul li .nickname{
            border-radius: 5px;
            background-color: #5cb85c;
            border: 1px solid rgba(204, 204, 204,.2);
            padding: 0 10px;
            height: 40px;
            display: inline-block;
            cursor: pointer;
            width: 150px;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        #Barrage ul li img{
            vertical-align: top;
            cursor: pointer;
        }

        /*文本框*/
        .txt{
            border: 2px solid #CCCCCC;
            outline-style:none;
            border-radius:5px;
            padding-left:4px;
            background-color: #F0F0F0;
            margin-top: 10px;
        }
        .txt:focus{
            border: 2px solid #66CCFF;
        }

    </style>

<body >
<div >

    <div id="Barrage" class=" col-md-offset-1">
        <input type="hidden" id="message_count" value="0">
        <ul onmouseenter="stopInterval()" onmouseleave="beginInterval()">
            <include file="message/detail" />
        </ul>
    </div>

    <div class=" col-md-offset-1" style="margin-top: 20px">
        <form action="" method="post" id="f2">
            <select name="user_id" class=" form-control"  style="width: 150px;display: inline-block">
                <option value="0">匿名</option>
                <foreach name="user" item="vo">
                    <option value="{$vo.id}">{$vo.nickname}</option>
                </foreach>
            </select>
            <input type="text" name="message" placeholder="输入内容" class=" form-control"  style="width: 850px;display: inline-block" />
            <button type="button" class="btn btn-success"  onClick="pub()" />发送</button
        </form>
    </div>

</div>
</body>


<script type="text/javascript">
    var interval = setInterval(bar, 2000);

    function bar() {
        $("ul li:eq(0)").animate({"margin-top": "-75px"}, "slow");
        setTimeout(function() {$("ul li:eq(0)").remove();}, 1000);
        if ($("#Barrage ul li").size() < 10) {
            $.get("{:url('detail')}" , {'num' : $("#message_count").val()} , function(redata){
                $("#Barrage ul").append(redata);
            })
        }
    }


    function pub() {
        $.post("{:url('add')}" , $("#f2").serialize() , function(redata){
            if(redata.code == 1){
                $("#Barrage ul").prepend(redata.msg);
            }else{
                Wind.use('layer' , function () {
                    layer.msg(redata.msg);
                })
            }
        })
    }



    function stopInterval() {
        clearInterval(interval);
    }

    function beginInterval() {
        interval = setInterval(bar, 2000);
    }

    function showBtn(obj) {
        $(obj).find('span').eq(3).toggle(1000);
    }

</script>


</html>
